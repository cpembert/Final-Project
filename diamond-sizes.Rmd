---
title: "diamond-sizes"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
knitr::opts_chunk$set(
  echo = FALSE
)
comma <- function(x) format(x, digits = 2, big.mark = ",")

smaller <- diamonds %>%
  filter(carat <= 2.5)
```

We have data about `r comma(nrow(diamonds))` diamonds. Only
`r nrow(diamonds) - nrow(smaller)` are larger than
2.5 carats. The distribution of the remainder is shown
below:

```{r}
smaller %>%
  ggplot(aes(carat)) +
  geom_freqpoly(binwidth = 0.01)
```

The figures below summarize the relationship btwn cut, color, and clarity and the diamond carat.

```{r}
ggplot(data = diamonds, aes(x = cut,  y = carat)) +
  geom_boxplot()

ggplot(data = diamonds, aes(x = color,  y = carat)) +
  geom_boxplot()

ggplot(data = diamonds, aes(x = clarity,  y = carat)) +
  geom_boxplot()
```

The following chart describes the 20 diamonds with the largest size (including ties):
```{r}
diamonds %>% filter(rank(desc(carat)) <= 20)
```

```{r}
larger = diamonds %>% filter((carat) > 2.5)
```

The percentage of diamonds that are larger than 2.5 carots is `r (nrow(larger)/nrow(diamonds))*100`.

